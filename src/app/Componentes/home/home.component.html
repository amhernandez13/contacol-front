<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
/>

<app-heder></app-heder>

<div id="home-container">
  <!-- Loader de Bootstrap -->
  <div *ngIf="isLoading" class="loader-overlay">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div id="function-container" *ngIf="!isLoading">
    <div
      class="function-selector"
      [class.active]="currentComponent === 'invoices'"
      [class.disabled]="
        currentComponent !== 'invoices' && currentComponent !== 'table'
      "
      (click)="showComponent('invoices')"
    >
      <h2>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          fill="currentColor"
          class="bi bi-receipt-cutoff"
          viewBox="0 0 16 16"
        >
          <path
            d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5M11.5 4a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"
          />
          <path
            d="M2.354.646a.5.5 0 0 0-.801.13l-.5 1A.5.5 0 0 0 1 2v13H.5a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H15V2a.5.5 0 0 0-.053-.224l-.5-1a.5.5 0 0 0-.8-.13L13 1.293l-.646-.647a.5.5 0 0 0-.708 0L11 1.293l-.646-.647a.5.5 0 0 0-.708 0L9 1.293 8.354.646a.5.5 0 0 0-.708 0L7 1.293 6.354.646a.5.5 0 0 0-.708 0L5 1.293 4.354.646a.5.5 0 0 0-.708 0L3 1.293zm-.217 1.198.51.51a.5.5 0 0 0 .707 0L4 1.707l.646.647a.5.5 0 0 0 .708 0L6 1.707l.646.647a.5.5 0 0 0 .708 0L8 1.707l.646.647a.5.5 0 0 0 .708 0L10 1.707l.646.647a.5.5 0 0 0 .708 0L12 1.707l.646.647a.5.5 0 0 0 .708 0l.509-.51.137.274V15H2V2.118z"
          />
        </svg>
        Comprobantes
      </h2>
    </div>

    <div
      class="function-selector"
      [class.active]="currentComponent === 'suppliers'"
      [class.disabled]="
        currentComponent !== 'suppliers' && currentComponent !== 'table'
      "
      (click)="showComponent('suppliers')"
    >
      <h2>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          fill="currentColor"
          class="bi bi-person-lines-fill"
          viewBox="0 0 16 16"
        >
          <path
            d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z"
          />
        </svg>
        Proveedores
      </h2>
    </div>

    <div
      class="function-selector"
      [class.active]="currentComponent === 'warehouse'"
      [class.disabled]="
        currentComponent !== 'warehouse' && currentComponent !== 'table'
      "
      (click)="redirectToWarehouse()"
    >
      <h2>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          fill="currentColor"
          class="bi bi-database"
          viewBox="0 0 16 16"
        >
          <path
            d="M4.318 2.687C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4c0-.374.356-.875 1.318-1.313M13 5.698V7c0 .374-.356.875-1.318 1.313C10.766 8.729 9.464 9 8 9s-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777A5 5 0 0 0 13 5.698M14 4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16s3.022-.289 4.096-.777C13.125 14.755 14 14.007 14 13zm-1 4.698V10c0 .374-.356.875-1.318 1.313C10.766 11.729 9.464 12 8 12s-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10s3.022-.289 4.096-.777A5 5 0 0 0 13 8.698m0 3V13c0 .374-.356.875-1.318 1.313C10.766 14.729 9.464 15 8 15s-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13s3.022-.289 4.096-.777c.324-.147.633-.323.904-.525"
          />
        </svg>
        Almacén de comprobantes
      </h2>
    </div>
  </div>

  <!-- Tabla de facturas a vencer -->
  <div id="table-container" *ngIf="!isLoading">
    <ng-container *ngIf="currentComponent === 'table'">
      <table>
        <thead>
          <tr>
            <th>Nro. Factura</th>
            <th>Tercero</th>
            <th>Emisión / Vencimiento</th>
            <th>Total</th>
            <th>Estado de pago</th>
            <th>Detalle</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let invoice of invoices">
            <td>{{ invoice.invoice }}</td>
            <td>{{ invoice.third_party }}</td>
            <td class="date-center">
              {{ invoice.issue_date | date : "dd-MM-yyyy" }} /
              {{ invoice.due_date | date : "dd-MM-yyyy" }}
            </td>
            <td>
              {{
                invoice.payment.invoice_total
                  | currency : "$" : "symbol" : "1.0-0"
              }}
            </td>
            <td>{{ invoice.invoice_status }}</td>
            <td class="icon-center">
              <!-- Verifica si el URL existe antes de mostrar el enlace -->
              <a *ngIf="invoice.url" [href]="invoice.url" target="_blank">
                <i class="bi bi-file-text"></i>
              </a>
              <i *ngIf="!invoice.url" class="bi bi-file-text disabled-icon"></i>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>

    <!-- Renderizado dinámico de componentes -->
    <ng-container *ngIf="currentComponent === 'invoices'">
      <app-invoices></app-invoices>
    </ng-container>
    <ng-container *ngIf="currentComponent === 'suppliers'">
      <app-suppliers></app-suppliers>
    </ng-container>
  </div>
</div>

<app-footer></app-footer>
